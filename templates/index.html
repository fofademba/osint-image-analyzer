<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Analyse OSINT & M√©tadonn√©es</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: auto; padding: 20px; }
        h1 { color: #2c3e50; }
        .result-item { margin-bottom: 10px; }
        .platform { font-weight: bold; }
        .status.available { color: green; }
        .status.unavailable { color: red; }
        .section { margin-top: 30px; }
    </style>
</head>
<body>
    <h1>üîç Analyse OSINT & M√©tadonn√©es d‚Äôimage</h1>

    <!-- Formulaire de recherche de nom d'utilisateur -->
    <form method="post">
        <label for="username">Nom d'utilisateur √† rechercher :</label><br>
        <input type="text" name="username" required>
        <button type="submit">Rechercher</button>
    </form>

    <div class="section">
        <h2>R√©sultats Sherlock :</h2>
        {{ result_sherlock|safe }}
    </div>

    <div class="section">
        <h2>R√©sultats Socialscan :</h2>
        {{ result_socialscan|safe }}
    </div>

    <div class="section">
        <h2>üîÅ Recherche invers√©e d'image</h2>
        <form id="image-form" enctype="multipart/form-data">
            <input type="file" name="image" accept="image/*" required>
            <button type="submit">Analyser l‚Äôimage</button>
        </form>
        <div id="result"></div>
    </div>

    <script>
        document.getElementById('image-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);

            fetch('/reverse-image', {
                method: 'POST',
                body: formData
            }).then(response => response.json())
              .then(data => {
                if (data.success) {
                    let html = "<h3>M√©tadonn√©es :</h3><ul>";
                    for (const [key, value] of Object.entries(data.metadata)) {
                        html += `<li><b>${key}</b>: ${value}</li>`;
                    }
                    html += "</ul>";

                    if (data.search_url) {
                        html += `<p><a href="${data.search_url}" target="_blank">Voir la recherche Google</a></p>`;
                        html += "<h3>R√©sultats :</h3><ul>";
                        data.matches.forEach(match => {
                            html += `<li><a href="${match.url}" target="_blank">${match.title}</a></li>`;
                        });
                        html += "</ul>";
                    }

                    document.getElementById('result').innerHTML = html;
                } else {
                    document.getElementById('result').innerText = "Erreur : " + data.error;
                }
            });
        });
    </script>
</body>
</html>
